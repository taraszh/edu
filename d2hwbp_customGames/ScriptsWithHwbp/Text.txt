Copipast from https://habr.com/ru/post/446516/


but works and dirextX hook simplified